
ISOLINUX 6.04   Copyright (C) 1994-2015 H. Peter Anvin et al
e%@)0(B[0;37;40m[?25l[2J[1;1H[0;30;44mlqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqk[2;1H[0;30;44mx[0;1;36;44m                                             NixOS                                              [0;30;44mx[3;1H[0;30;44mtqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqu[4;1H[0;30;44mx[0;7;37;40m NixOS 24.05.20241230.b134951 Installer                                                         [0;30;44mx[5;1H[0;30;44mx[0;37;44m NixOS 24.05.20241230.b134951 Installer (nomodeset)                                             [0;30;44mx[6;1H[0;30;44mx[0;37;44m NixOS 24.05.20241230.b134951 Installer (copytoram)                                             [0;30;44mx[7;1H[0;30;44mx[0;37;44m NixOS 24.05.20241230.b134951 Installer (debug)                                                 [0;30;44mx[8;1H[0;30;44mx[0;37;44m NixOS 24.05.20241230.b134951 Installer (serial console=ttyS0,115200n8)                         [0;30;44mx[9;1H[0;30;44mx[0;37;44m Memtest86+                                                                                     [0;30;44mx[10;1H[0;30;44mmqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqj[0;31;40m[34;36HPress [Tab] to edit options[0;37;40m[35;1H[0;37;40m[35;1H[K[K[36;1H[33;34H[0;37;40mAutomatic boot in [0;1;37;40m10[0;37;40m seconds...[33;34H[0;37;40m Automatic boot in [0;1;37;40m9[0;37;40m seconds... [33;35H[0;37;40mAutomatic boot in [0;1;37;40m8[0;37;40m seconds...[33;35H[0;37;40mAutomatic boot in [0;1;37;40m7[0;37;40m seconds...[33;35H[0;37;40mAutomatic boot in [0;1;37;40m6[0;37;40m seconds...[33;35H[0;37;40mAutomatic boot in [0;1;37;40m5[0;37;40m seconds...[33;35H[0;37;40mAutomatic boot in [0;1;37;40m4[0;37;40m seconds...[33;35H[0;37;40mAutomatic boot in [0;1;37;40m3[0;37;40m seconds...[33;35H[0;37;40mAutomatic boot in [0;1;37;40m2[0;37;40m seconds...[33;34H[0;37;40m Automatic boot in [0;1;37;40m1[0;37;40m second... [1;1H[0;30;44mlqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqk[2;1H[0;30;44mx[0;1;36;44m                                             NixOS                                              [0;30;44mx[3;1H[0;30;44mtqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqu[4;1H[0;30;44mx[0;7;37;40m NixOS 24.05.20241230.b134951 Installer                                                         [0;30;44mx[5;1H[0;30;44mx[0;37;44m NixOS 24.05.20241230.b134951 Installer (nomodeset)                                             [0;30;44mx[6;1H[0;30;44mx[0;37;44m NixOS 24.05.20241230.b134951 Installer (copytoram)                                             [0;30;44mx[7;1H[0;30;44mx[0;37;44m NixOS 24.05.20241230.b134951 Installer (debug)                                                 [0;30;44mx[8;1H[0;30;44mx[0;37;44m NixOS 24.05.20241230.b134951 Installer (serial console=ttyS0,115200n8)                         [0;30;44mx[9;1H[0;30;44mx[0;37;44m Memtest86+                                                                                     [0;30;44mx[10;1H[0;30;44mmqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqj[0;31;40m[34;36HPress [Tab] to edit options[0;37;40m[35;1H[?25he%@)0(B[0;37;40m[?25l[2J[?25h[35;1H[0mLoading /boot/bzImage... ok
Loading /boot/initrd...ok


[1;32m<<< Welcome to NixOS 24.05.20241230.b134951 (x86_64) - ttyS0 >>>[0m
The "nixos" and "root" accounts have empty passwords.

To log in over ssh you must set a password for either "nixos" or "root"
with `passwd` (prefix with `sudo` for "root"), or add your public key to
/home/nixos/.ssh/authorized_keys or /root/.ssh/authorized_keys.

If you need a wireless connection, type
`sudo systemctl start wpa_supplicant` and configure a
network using `wpa_cli`. See the NixOS manual for details.


Run 'nixos-help' for the NixOS manual.

nixos login: nixos (automatic login)
if [ "$(id -u)" -eq 0 ]; then echo __ROOT__; else echo __USER__; fi

if [ "$(id -u)" -eq 0 ]; then echo __ROOT__; else echo __USER__; fi
[?2004h
[1;32m[]0;nixos@nixos: ~nixos@nixos:~]$[0m export PS1='PRE-NIXOS> '
if [ "$(id -u)" -eq 0 ]; then echo __ROOT__; else echo __USER__; fi
[?2004lexport PS1='PRE-NIXOS> '
:
:
__USER__
[?2004h
[1;32m[]0;nixos@nixos: ~nixos@nixos:~]$[0m export PS1='PRE-NIXOS> '
command -v disko >/dev/null 2>&1 && echo OK || echo MISSING
[?2004l[?2004hPRE-NIXOS> :
[?2004l[?2004hPRE-NIXOS> command -v disko >/dev/null 2>&1 && echo OK || echo MISSING
command -v disko >/dev/null 2>&1 && echo OK || echo MISSING
command -v disko >/dev/null 2>&1 && echo OK || echo MISSING
[?2004lOK
[?2004hPRE-NIXOS> command -v disko >/dev/null 2>&1 && echo OK || echo MISSING
[?2004lOK
[?2004hPRE-NIXOS> command -v findmnt >/dev/null 2>&1 && echo OK || echo MISSING
command -v lsblk >/dev/null 2>&1 && echo OK || echo MISSING
command -v disko >/dev/null 2>&1 && echo OK || echo MISSING
[?2004lOK
[?2004hPRE-NIXOS> command -v findmnt >/dev/null 2>&1 && echo OK || echo MISSING
[?2004lOK
[?2004hPRE-NIXOS> command -v wipefs >/dev/null 2>&1 && echo OK || echo MISSING
cat /run/pre-nixos/storage-status 2>/dev/null || true
command -v lsblk >/dev/null 2>&1 && echo OK || echo MISSING
[?2004lOK
[?2004hPRE-NIXOS> command -v wipefs >/dev/null 2>&1 && echo OK || echo MISSING
[?2004lOK
[?2004hPRE-NIXOS> cat /run/pre-nixos/storage-status 2>/dev/null || true
cat /run/pre-nixos/storage-status 2>/dev/null || true
cat /run/pre-nixos/storage-status 2>/dev/null || true
[?2004l[?2004hPRE-NIXOS> cat /run/pre-nixos/storage-status 2>/dev/null || true
[?2004l[?2004hPRE-NIXOS> cat /run/pre-nixos/storage-status 2>/dev/null || true
cat /run/pre-nixos/storage-status 2>/dev/null || true
cat /run/pre-nixos/storage-status 2>/dev/null || true
[?2004l[?2004hPRE-NIXOS> cat /run/pre-nixos/storage-status 2>/dev/null || true
[?2004l[?2004hPRE-NIXOS> cat /run/pre-nixos/storage-status 2>/dev/null || true
cat /run/pre-nixos/storage-status 2>/dev/null || true
cat /run/pre-nixos/storage-status 2>/dev/null || true
[?2004l[?2004hPRE-NIXOS> cat /run/pre-nixos/storage-status 2>/dev/null || true
[?2004l[?2004hPRE-NIXOS> cat /run/pre-nixos/storage-status 2>/dev/null || true
cat /run/pre-nixos/storage-status 2>/dev/null || true
cat /run/pre-nixos/storage-status 2>/dev/null || true
[?2004l[?2004hPRE-NIXOS> cat /run/pre-nixos/storage-status 2>/dev/null || true
[?2004l[?2004hPRE-NIXOS> cat /run/pre-nixos/storage-status 2>/dev/null || true
cat /run/pre-nixos/storage-status 2>/dev/null || true
cat /run/pre-nixos/storage-status 2>/dev/null || true
[?2004l[?2004hPRE-NIXOS> cat /run/pre-nixos/storage-status 2>/dev/null || true
[?2004l[?2004hPRE-NIXOS> cat /run/pre-nixos/storage-status 2>/dev/null || true
cat /run/pre-nixos/storage-status 2>/dev/null || true
cat /run/pre-nixos/storage-status 2>/dev/null || true
[?2004l[?2004hPRE-NIXOS> cat /run/pre-nixos/storage-status 2>/dev/null || true
[?2004l[?2004hPRE-NIXOS> cat /run/pre-nixos/storage-status 2>/dev/null || true
cat /run/pre-nixos/storage-status 2>/dev/null || true
cat /run/pre-nixos/storage-status 2>/dev/null || true
[?2004l[?2004hPRE-NIXOS> cat /run/pre-nixos/storage-status 2>/dev/null || true
[?2004l[?2004hPRE-NIXOS> cat /run/pre-nixos/storage-status 2>/dev/null || true
cat /run/pre-nixos/storage-status 2>/dev/null || true
cat /run/pre-nixos/storage-status 2>/dev/null || true
[?2004l[?2004hPRE-NIXOS> cat /run/pre-nixos/storage-status 2>/dev/null || true
[?2004l[?2004hPRE-NIXOS> cat /run/pre-nixos/storage-status 2>/dev/null || true
cat /run/pre-nixos/storage-status 2>/dev/null || true
cat /run/pre-nixos/storage-status 2>/dev/null || true
[?2004lSTATE=failed
DETAIL=auto-applied
[?2004hPRE-NIXOS> cat /run/pre-nixos/storage-status 2>/dev/null || true
[?2004lSTATE=failed
DETAIL=auto-applied
[?2004hPRE-NIXOS> journalctl --no-pager -u pre-nixos.service -b || true
ip -o -4 addr show dev lan 2>/dev/null || true
cat /run/pre-nixos/storage-status 2>/dev/null || true
[?2004ljournalctl --no-pager -u pre-nixos.service -b || true
STATE=failed
DETAIL=auto-applied
[?2004hPRE-NIXOS> journalctl --no-pager -u pre-nixos.service -b || true
[?2004lip -o -4 addr show dev lan 2>/dev/null || true
ip -o -4 addr show dev lan 2>/dev/null || true
Oct 17 02:56:02 nixos systemd[1]: Starting Pre-NixOS setup...
Oct 17 02:56:23 nixos pre-nixos-start[896]: {"authorized_key": null, "event": "pre_nixos.network.configure_lan.start", "net_path": "/sys/class/net", "network_dir": "/etc/systemd/network", "root_home": "/root", "ssh_dir": "/etc/ssh", "ssh_service": "sshd", "timestamp": "2025-10-17T02:56:23.521184+00:00"}
Oct 17 02:56:23 nixos pre-nixos-start[896]: {"attempts": 30, "delay_seconds": 2.0, "event": "pre_nixos.network.wait_for_lan.start", "net_path": "/sys/class/net", "timestamp": "2025-10-17T02:56:23.536166+00:00"}
Oct 17 02:56:23 nixos pre-nixos-start[896]: {"command": ["ip", "link", "set", "ens4", "up"], "event": "pre_nixos.network.command.start", "timestamp": "2025-10-17T02:56:23.543260+00:00"}
Oct 17 02:56:23 nixos pre-nixos-start[896]: {"command": ["ip", "link", "set", "ens4", "up"], "event": "pre_nixos.network.command.finished", "returncode": 0, "status": "success", "timestamp": "2025-10-17T02:56:23.766444+00:00"}
Oct 17 02:56:23 nixos pre-nixos-start[896]: {"event": "pre_nixos.network.identify_lan.detected", "interface": "ens4", "signal": "carrier", "timestamp": "2025-10-17T02:56:23.776267+00:00"}
Oct 17 02:56:23 nixos pre-nixos-start[896]: {"event": "pre_nixos.network.wait_for_lan.detected", "interface": "ens4", "timestamp": "2025-10-17T02:56:23.777664+00:00"}
Oct 17 02:56:23 nixos pre-nixos-start[896]: {"event": "pre_nixos.network.configure_lan.detected_interface", "interface": "ens4", "timestamp": "2025-10-17T02:56:23.778574+00:00"}
Oct 17 02:56:23 nixos pre-nixos-start[896]: {"event": "pre_nixos.network.write_lan_rename_rule.start", "net_path": "/sys/class/net", "rules_dir": "/etc/systemd/network", "timestamp": "2025-10-17T02:56:23.779221+00:00"}
Oct 17 02:56:23 nixos pre-nixos-start[896]: {"attempts": 30, "delay_seconds": 2.0, "event": "pre_nixos.network.wait_for_lan.start", "net_path": "/sys/class/net", "timestamp": "2025-10-17T02:56:23.780086+00:00"}
Oct 17 02:56:23 nixos pre-nixos-start[896]: {"command": ["ip", "link", "set", "ens4", "up"], "event": "pre_nixos.network.command.start", "timestamp": "2025-10-17T02:56:23.782430+00:00"}
Oct 17 02:56:23 nixos pre-nixos-start[896]: {"command": ["ip", "link", "set", "ens4", "up"], "event": "pre_nixos.network.command.finished", "returncode": 0, "status": "success", "timestamp": "2025-10-17T02:56:23.866697+00:00"}
Oct 17 02:56:23 nixos pre-nixos-start[896]: {"event": "pre_nixos.network.identify_lan.detected", "interface": "ens4", "signal": "carrier", "timestamp": "2025-10-17T02:56:23.876377+00:00"}
Oct 17 02:56:23 nixos pre-nixos-start[896]: {"event": "pre_nixos.network.wait_for_lan.detected", "interface": "ens4", "timestamp": "2025-10-17T02:56:23.878084+00:00"}
Oct 17 02:56:23 nixos pre-nixos-start[896]: {"event": "pre_nixos.network.write_lan_rename_rule.finished", "interface": "ens4", "rule_path": "/etc/systemd/network/10-lan.link", "timestamp": "2025-10-17T02:56:23.889609+00:00"}
Oct 17 02:56:23 nixos pre-nixos-start[896]: {"event": "pre_nixos.network.configure_lan.network_file_written", "network_file": "/etc/systemd/network/20-lan.network", "timestamp": "2025-10-17T02:56:23.902300+00:00"}
Oct 17 02:56:23 nixos pre-nixos-start[896]: {"command": ["ip", "link", "set", "ens4", "down"], "event": "pre_nixos.network.command.start", "timestamp": "2025-10-17T02:56:23.903580+00:00"}
Oct 17 02:56:24 nixos pre-nixos-start[896]: {"command": ["ip", "link", "set", "ens4", "down"], "event": "pre_nixos.network.command.finished", "returncode": 0, "status": "success", "timestamp": "2025-10-17T02:56:24.027338+00:00"}
Oct 17 02:56:24 nixos pre-nixos-start[896]: {"command": ["ip", "link", "set", "ens4", "name", "lan"], "event": "pre_nixos.network.command.start", "timestamp": "2025-10-17T02:56:24.030381+00:00"}
Oct 17 02:56:24 nixos pre-nixos-start[896]: {"command": ["ip", "link", "set", "ens4", "name", "lan"], "event": "pre_nixos.network.command.finished", "returncode": 0, "status": "success", "timestamp": "2025-10-17T02:56:24.163938+00:00"}
Oct 17 02:56:24 nixos pre-nixos-start[896]: {"command": ["ip", "link", "set", "lan", "up"], "event": "pre_nixos.network.command.start", "timestamp": "2025-10-17T02:56:24.167156+00:00"}
Oct 17 02:56:24 nixos pre-nixos-start[896]: {"command": ["ip", "link", "set", "lan", "up"], "event": "pre_nixos.network.command.finished", "returncode": 0, "status": "success", "timestamp": "2025-10-17T02:56:24.300599+00:00"}
Oct 17 02:56:24 nixos pre-nixos-start[896]: {"command": ["systemctl", "restart", "systemd-networkd"], "event": "pre_nixos.network.systemctl.start", "ignore_missing": true, "timestamp": "2025-10-17T02:56:24.308232+00:00"}
Oct 17 02:56:26 nixos pre-nixos-start[896]: {"command": ["systemctl", "restart", "systemd-networkd"], "event": "pre_nixos.network.systemctl.finished", "returncode": 0, "status": "success", "timestamp": "2025-10-17T02:56:26.282972+00:00"}
Oct 17 02:56:26 nixos pre-nixos-start[896]: {"authorized_key": "/nix/store/gcskgp15adhp9y8dm8djf61giz3gl8fn-pre-nixos-0.1.0/lib/python3.11/site-packages/pre_nixos/root_key.pub", "event": "pre_nixos.network.secure_ssh.start", "ssh_dir": "/etc/ssh", "ssh_service": "sshd", "timestamp": "2025-10-17T02:56:26.292383+00:00"}
Oct 17 02:56:26 nixos pre-nixos-start[896]: {"authorized_keys_path": "/root/.ssh/authorized_keys", "event": "pre_nixos.network.secure_ssh.authorized_key_written", "timestamp": "2025-10-17T02:56:26.452611+00:00"}
Oct 17 02:56:26 nixos pre-nixos-start[896]: {"command": ["systemctl", "reload-or-restart", "--no-block", "sshd"], "event": "pre_nixos.network.systemctl.start", "ignore_missing": false, "timestamp": "2025-10-17T02:56:26.456294+00:00"}
Oct 17 02:56:27 nixos pre-nixos-start[896]: {"command": ["systemctl", "reload-or-restart", "--no-block", "sshd"], "event": "pre_nixos.network.systemctl.finished", "returncode": 0, "status": "success", "timestamp": "2025-10-17T02:56:27.405610+00:00"}
Oct 17 02:56:27 nixos pre-nixos-start[896]: {"authorized_keys_path": "/root/.ssh/authorized_keys", "event": "pre_nixos.network.secure_ssh.finished", "timestamp": "2025-10-17T02:56:27.414631+00:00"}
Oct 17 02:56:27 nixos pre-nixos-start[896]: {"event": "pre_nixos.network.configure_lan.finished", "interface": "ens4", "network_file": "/etc/systemd/network/20-lan.network", "timestamp": "2025-10-17T02:56:27.421083+00:00"}
Oct 17 02:56:28 nixos pre-nixos-start[896]: {"detected": true, "event": "pre_nixos.apply.disko_mode", "mode": "destroy,format,mount", "supports_yes_wipe": true, "timestamp": "2025-10-17T02:56:28.812332+00:00"}
Oct 17 02:56:28 nixos pre-nixos-start[896]: {"dry_run": false, "event": "pre_nixos.apply.apply_plan.start", "execute": true, "timestamp": "2025-10-17T02:56:28.820117+00:00"}
Oct 17 02:56:28 nixos pre-nixos-start[896]: {"config_path": "/var/log/pre-nixos/disko-config.nix", "event": "pre_nixos.apply.apply_plan.config_written", "timestamp": "2025-10-17T02:56:28.844518+00:00"}
Oct 17 02:56:28 nixos pre-nixos-start[896]: {"command": "disko --mode destroy,format,mount --yes-wipe-all-disks --root-mountpoint /mnt /var/log/pre-nixos/disko-config.nix", "event": "pre_nixos.apply.apply_plan.command_scheduled", "timestamp": "2025-10-17T02:56:28.855642+00:00"}
Oct 17 02:56:28 nixos pre-nixos-start[896]: {"command": "disko --mode destroy,format,mount --yes-wipe-all-disks --root-mountpoint /mnt /var/log/pre-nixos/disko-config.nix", "event": "pre_nixos.apply.command.start", "execute": true, "timestamp": "2025-10-17T02:56:28.857020+00:00"}
Oct 17 02:56:29 nixos pre-nixos-start[941]: disko version 1.12.0-dirty
Oct 17 02:57:27 nixos pre-nixos-start[946]: warning: error: unable to download 'https://cache.nixos.org/nix-cache-info': Couldn't connect to server (7); retrying in 282 ms
Oct 17 02:57:28 nixos pre-nixos-start[946]: warning: error: unable to download 'https://cache.nixos.org/nix-cache-info': Couldn't connect to server (7); retrying in 625 ms
Oct 17 02:57:29 nixos pre-nixos-start[946]: warning: error: unable to download 'https://cache.nixos.org/nix-cache-info': Couldn't connect to server (7); retrying in 1146 ms
Oct 17 02:57:30 nixos pre-nixos-start[946]: warning: error: unable to download 'https://cache.nixos.org/nix-cache-info': Couldn't connect to server (7); retrying in 2118 ms
Oct 17 02:57:32 nixos pre-nixos-start[946]: warning: unable to download 'https://cache.nixos.org/nix-cache-info': Couldn't connect to server (7)
Oct 17 02:57:32 nixos pre-nixos-start[946]: these 3 derivations will be built:
Oct 17 02:57:32 nixos pre-nixos-start[946]:   /nix/store/mx18j6kkblmv203y2b7ix34a3xn473bw-die-hook.drv
Oct 17 02:57:32 nixos pre-nixos-start[946]:   /nix/store/jxrh5f4b4ddpy9zvqx25x3v8519nrqjw-make-binary-wrapper-hook.drv
Oct 17 02:57:32 nixos pre-nixos-start[946]:   /nix/store/3nq1p4m6r5is7sb06h0m6rcrxjqg5jlf-disko-destroy-format-mount.drv
Oct 17 02:57:34 nixos pre-nixos-start[946]: building '/nix/store/mx18j6kkblmv203y2b7ix34a3xn473bw-die-hook.drv'...
Oct 17 02:57:36 nixos pre-nixos-start[946]: building '/nix/store/jxrh5f4b4ddpy9zvqx25x3v8519nrqjw-make-binary-wrapper-hook.drv'...
Oct 17 02:57:38 nixos pre-nixos-start[946]: building '/nix/store/3nq1p4m6r5is7sb06h0m6rcrxjqg5jlf-disko-destroy-format-mount.drv'...
Oct 17 02:57:40 nixos pre-nixos-start[1050]: umount: /mnt: not mounted
Oct 17 02:57:40 nixos pre-nixos-start[1052]: ++ realpath /dev/vda
Oct 17 02:57:40 nixos pre-nixos-start[1051]: + disk=/dev/vda
Oct 17 02:57:40 nixos pre-nixos-start[1051]: + lsblk -a -f
Oct 17 02:57:40 nixos pre-nixos-start[1053]: NAME  FSTYPE   FSVER            LABEL                      UUID                                 FSAVAIL FSUSE% MOUNTPOINTS
Oct 17 02:57:40 nixos pre-nixos-start[1053]: fd0
Oct 17 02:57:40 nixos pre-nixos-start[1053]: loop0 squashfs 4.0                                                                                    0   100% /nix/.ro-store
Oct 17 02:57:40 nixos pre-nixos-start[1053]: loop1
Oct 17 02:57:40 nixos pre-nixos-start[1053]: loop2
Oct 17 02:57:40 nixos pre-nixos-start[1053]: loop3
Oct 17 02:57:40 nixos pre-nixos-start[1053]: loop4
Oct 17 02:57:40 nixos pre-nixos-start[1053]: loop5
Oct 17 02:57:40 nixos pre-nixos-start[1053]: loop6
Oct 17 02:57:40 nixos pre-nixos-start[1053]: loop7
Oct 17 02:57:40 nixos pre-nixos-start[1053]: sr0   iso9660  Joliet Extension nixos-minimal-24.05-x86_64 1980-01-01-00-00-00-00                     0   100% /iso
Oct 17 02:57:40 nixos pre-nixos-start[1053]: vda
Oct 17 02:57:40 nixos pre-nixos-start[1054]: + lsblk --output-all --json
Oct 17 02:57:40 nixos pre-nixos-start[1056]: + bash -x
Oct 17 02:57:40 nixos pre-nixos-start[1057]: ++ dirname /nix/store/m09kvvjzvjaqj4fjs16jqsj6lmfqkd99-disk-deactivate/disk-deactivate
Oct 17 02:57:41 nixos pre-nixos-start[1055]: + jq -r -f /nix/store/m09kvvjzvjaqj4fjs16jqsj6lmfqkd99-disk-deactivate/zfs-swap-deactivate.jq
Oct 17 02:57:41 nixos pre-nixos-start[1058]: + lsblk --output-all --json
Oct 17 02:57:41 nixos pre-nixos-start[1060]: + bash -x
Oct 17 02:57:41 nixos pre-nixos-start[1061]: ++ dirname /nix/store/m09kvvjzvjaqj4fjs16jqsj6lmfqkd99-disk-deactivate/disk-deactivate
Oct 17 02:57:41 nixos pre-nixos-start[1059]: + jq -r --arg disk_to_clear /dev/vda -f /nix/store/m09kvvjzvjaqj4fjs16jqsj6lmfqkd99-disk-deactivate/disk-deactivate.jq
Oct 17 02:57:41 nixos pre-nixos-start[1060]: + set -fu
Oct 17 02:57:41 nixos pre-nixos-start[1062]: ++ type zdb
Oct 17 02:57:41 nixos pre-nixos-start[1063]: ++ zdb -l /dev/vda
Oct 17 02:57:41 nixos pre-nixos-start[1064]: ++ sed -nr 's/ +name: '\''(.*)'\''/\1/p'
Oct 17 02:57:42 nixos pre-nixos-start[1060]: + zpool=
Oct 17 02:57:42 nixos pre-nixos-start[1060]: + [[ -n '' ]]
Oct 17 02:57:42 nixos pre-nixos-start[1060]: + unset zpool
Oct 17 02:57:42 nixos pre-nixos-start[1155]: ++ lsblk /dev/vda -l -p -o type,name
Oct 17 02:57:42 nixos pre-nixos-start[1156]: ++ awk 'match($1,"raid.*") {print $2}'
Oct 17 02:57:42 nixos pre-nixos-start[1060]: + md_dev=
Oct 17 02:57:42 nixos pre-nixos-start[1060]: + [[ -n '' ]]
Oct 17 02:57:42 nixos pre-nixos-start[1060]: + wipefs --all -f /dev/vda
Oct 17 02:57:42 nixos pre-nixos-start[1060]: + dd if=/dev/zero of=/dev/vda bs=440 count=1
Oct 17 02:57:42 nixos pre-nixos-start[1158]: 1+0 records in
Oct 17 02:57:42 nixos pre-nixos-start[1158]: 1+0 records out
Oct 17 02:57:42 nixos pre-nixos-start[1158]: 440 bytes copied, 0.0168899 s, 26.1 kB/s
Oct 17 02:57:42 nixos pre-nixos-start[1051]: + lsblk -a -f
Oct 17 02:57:43 nixos pre-nixos-start[1159]: NAME  FSTYPE   FSVER            LABEL                      UUID                                 FSAVAIL FSUSE% MOUNTPOINTS
Oct 17 02:57:43 nixos pre-nixos-start[1159]: fd0
Oct 17 02:57:43 nixos pre-nixos-start[1159]: loop0 squashfs 4.0                                                                                    0   100% /nix/.ro-store
Oct 17 02:57:43 nixos pre-nixos-start[1159]: loop1
Oct 17 02:57:43 nixos pre-nixos-start[1159]: loop2
Oct 17 02:57:43 nixos pre-nixos-start[1159]: loop3
Oct 17 02:57:43 nixos pre-nixos-start[1159]: loop4
Oct 17 02:57:43 nixos pre-nixos-start[1159]: loop5
Oct 17 02:57:43 nixos pre-nixos-start[1159]: loop6
Oct 17 02:57:43 nixos pre-nixos-start[1159]: loop7
Oct 17 02:57:43 nixos pre-nixos-start[1159]: sr0   iso9660  Joliet Extension nixos-minimal-24.05-x86_64 1980-01-01-00-00-00-00                     0   100% /iso
Oct 17 02:57:43 nixos pre-nixos-start[1159]: vda
Oct 17 02:57:43 nixos pre-nixos-start[1161]: ++ mktemp -d
Oct 17 02:57:43 nixos pre-nixos-start[941]: + disko_devices_dir=/tmp/tmp.fxAVBSrUqM
Oct 17 02:57:44 nixos pre-nixos-start[941]: + trap 'rm -rf "$disko_devices_dir"' EXIT
Oct 17 02:57:44 nixos pre-nixos-start[941]: + mkdir -p /tmp/tmp.fxAVBSrUqM
Oct 17 02:57:44 nixos pre-nixos-start[1165]: + destroy=1
Oct 17 02:57:44 nixos pre-nixos-start[1165]: + device=/dev/vda
Oct 17 02:57:44 nixos pre-nixos-start[1165]: + imageName=vda
Oct 17 02:57:44 nixos pre-nixos-start[1165]: + imageSize=2G
Oct 17 02:57:44 nixos pre-nixos-start[1165]: + name=vda
Oct 17 02:57:44 nixos pre-nixos-start[1165]: + type=disk
Oct 17 02:57:44 nixos pre-nixos-start[1166]: + device=/dev/vda
Oct 17 02:57:44 nixos pre-nixos-start[1166]: + efiGptPartitionFirst=1
Oct 17 02:57:44 nixos pre-nixos-start[1166]: + type=gpt
Oct 17 02:57:44 nixos pre-nixos-start[1166]: + blkid /dev/vda
Oct 17 02:57:44 nixos pre-nixos-start[1166]: + sgdisk --clear /dev/vda
Oct 17 02:57:45 nixos pre-nixos-start[1168]: Creating new GPT entries in memory.
Oct 17 02:57:45 nixos pre-nixos-start[1168]: The operation has completed successfully.
Oct 17 02:57:45 nixos pre-nixos-start[1166]: + sgdisk --align-end --new=1:0:+1G --partition-guid=1:R --change-name=1:disk-vda-vda1 --typecode=1:EF00 --attributes=1:=:0 /dev/vda
Oct 17 02:57:47 nixos pre-nixos-start[1170]: The operation has completed successfully.
Oct 17 02:57:47 nixos pre-nixos-start[1166]: + partprobe /dev/vda
Oct 17 02:57:47 nixos pre-nixos-start[1166]: + udevadm trigger --subsystem-match=block
Oct 17 02:57:47 nixos pre-nixos-start[1166]: + udevadm settle --timeout 120
Oct 17 02:57:50 nixos pre-nixos-start[1166]: + sgdisk --align-end --new=2:0:-0 --partition-guid=2:R --change-name=2:disk-vda-vda2 --typecode=2:8300 --attributes=2:=:0 /dev/vda
Oct 17 02:57:51 nixos pre-nixos-start[1209]: The operation has completed successfully.
Oct 17 02:57:51 nixos pre-nixos-start[1166]: + partprobe /dev/vda
Oct 17 02:57:51 nixos pre-nixos-start[1166]: + udevadm trigger --subsystem-match=block
Oct 17 02:57:52 nixos pre-nixos-start[1166]: + udevadm settle --timeout 120
Oct 17 02:57:56 nixos pre-nixos-start[1257]: + device=/dev/disk/by-partlabel/disk-vda-vda1
Oct 17 02:57:56 nixos pre-nixos-start[1257]: + extraArgs=('-n' 'EFI')
Oct 17 02:57:56 nixos pre-nixos-start[1257]: + declare -a extraArgs
Oct 17 02:57:56 nixos pre-nixos-start[1257]: + format=vfat
Oct 17 02:57:56 nixos pre-nixos-start[1257]: + mountOptions=('umask=0077')
Oct 17 02:57:56 nixos pre-nixos-start[1257]: + declare -a mountOptions
Oct 17 02:57:56 nixos pre-nixos-start[1257]: + mountpoint=/boot
Oct 17 02:57:56 nixos pre-nixos-start[1257]: + type=filesystem
Oct 17 02:57:56 nixos pre-nixos-start[1259]: + blkid /dev/disk/by-partlabel/disk-vda-vda1
Oct 17 02:57:56 nixos pre-nixos-start[1260]: + grep -q TYPE=
Oct 17 02:57:56 nixos pre-nixos-start[1257]: + mkfs.vfat -n EFI /dev/disk/by-partlabel/disk-vda-vda1
Oct 17 02:57:57 nixos pre-nixos-start[1261]: mkfs.fat 4.2 (2021-01-31)
Oct 17 02:57:57 nixos pre-nixos-start[1262]: + device=/dev/disk/by-partlabel/disk-vda-vda2
Oct 17 02:57:57 nixos pre-nixos-start[1262]: + type=lvm_pv
Oct 17 02:57:57 nixos pre-nixos-start[1262]: + vg=main
Oct 17 02:57:57 nixos pre-nixos-start[1264]: + blkid /dev/disk/by-partlabel/disk-vda-vda2
Oct 17 02:57:57 nixos pre-nixos-start[1265]: + grep -q TYPE=
Oct 17 02:57:57 nixos pre-nixos-start[1262]: + pvcreate /dev/disk/by-partlabel/disk-vda-vda2
Oct 17 02:57:58 nixos pre-nixos-start[1267]:   Physical volume "/dev/disk/by-partlabel/disk-vda-vda2" successfully created.
Oct 17 02:57:58 nixos pre-nixos-start[1262]: + echo /dev/disk/by-partlabel/disk-vda-vda2
Oct 17 02:57:58 nixos pre-nixos-start[1269]: + name=main
Oct 17 02:57:58 nixos pre-nixos-start[1269]: + type=lvm_vg
Oct 17 02:57:58 nixos pre-nixos-start[1269]: + modprobe dm-snapshot
Oct 17 02:57:58 nixos pre-nixos-start[1269]: + readarray -t lvm_devices
Oct 17 02:57:58 nixos pre-nixos-start[1272]: ++ cat /tmp/tmp.fxAVBSrUqM/lvm_main
Oct 17 02:57:58 nixos pre-nixos-start[1269]: + vgdisplay main
Oct 17 02:57:59 nixos pre-nixos-start[1276]:   Volume group "main" not found
Oct 17 02:57:59 nixos pre-nixos-start[1276]:   Cannot process volume group main
Oct 17 02:57:59 nixos pre-nixos-start[1269]: + vgcreate main /dev/disk/by-partlabel/disk-vda-vda2
Oct 17 02:57:59 nixos pre-nixos-start[1278]:   Volume group "main" successfully created
Oct 17 02:57:59 nixos pre-nixos-start[1269]: + lvdisplay main/slash
Oct 17 02:57:59 nixos pre-nixos-start[1280]:   Failed to find logical volume "main/slash"
Oct 17 02:58:00 nixos pre-nixos-start[1269]: + lvcreate --yes -L 3068M -n slash main
Oct 17 02:58:01 nixos pre-nixos-start[1281]:   Logical volume "slash" created.
Oct 17 02:58:01 nixos pre-nixos-start[1269]: + lvdisplay main/swap
Oct 17 02:58:01 nixos pre-nixos-start[1289]:   Failed to find logical volume "main/swap"
Oct 17 02:58:01 nixos pre-nixos-start[1269]: + lvcreate --yes -L 4M -n swap main
Oct 17 02:58:02 nixos pre-nixos-start[1292]:   Volume group "main" has insufficient free space (0 extents): 1 required.
Oct 17 02:58:02 nixos pre-nixos-start[941]: + rm -rf /tmp/tmp.fxAVBSrUqM
Oct 17 02:58:02 nixos pre-nixos-start[896]: {"command": "disko --mode destroy,format,mount --yes-wipe-all-disks --root-mountpoint /mnt /var/log/pre-nixos/disko-config.nix", "event": "pre_nixos.apply.command.finished", "returncode": 5, "status": "error", "timestamp": "2025-10-17T02:58:02.232194+00:00"}
Oct 17 02:58:02 nixos pre-nixos-start[896]: {
Oct 17 02:58:02 nixos pre-nixos-start[896]:   "arrays": [],
Oct 17 02:58:02 nixos pre-nixos-start[896]:   "vgs": [
Oct 17 02:58:02 nixos pre-nixos-start[896]:     {
Oct 17 02:58:02 nixos pre-nixos-start[896]:       "name": "main",
Oct 17 02:58:02 nixos pre-nixos-start[896]:       "devices": [
Oct 17 02:58:02 nixos pre-nixos-start[896]:         "vda2"
Oct 17 02:58:02 nixos pre-nixos-start[896]:       ]
Oct 17 02:58:02 nixos pre-nixos-start[896]:     }
Oct 17 02:58:02 nixos pre-nixos-start[896]:   ],
Oct 17 02:58:02 nixos pre-nixos-start[896]:   "lvs": [
Oct 17 02:58:02 nixos pre-nixos-start[896]:     {
Oct 17 02:58:02 nixos pre-nixos-start[896]:       "name": "slash",
Oct 17 02:58:02 nixos pre-nixos-start[896]:       "vg": "main",
Oct 17 02:58:02 nixos pre-nixos-start[896]:       "size": "3068M"
Oct 17 02:58:02 nixos pre-nixos-start[896]:     },
Oct 17 02:58:02 nixos pre-nixos-start[896]:     {
Oct 17 02:58:02 nixos pre-nixos-start[896]:       "name": "swap",
Oct 17 02:58:02 nixos pre-nixos-start[896]:       "vg": "main",
Oct 17 02:58:02 nixos pre-nixos-start[896]:       "size": "4M"
Oct 17 02:58:02 nixos pre-nixos-start[896]:     }
Oct 17 02:58:02 nixos pre-nixos-start[896]:   ],
Oct 17 02:58:02 nixos pre-nixos-start[896]:   "partitions": {
Oct 17 02:58:02 nixos pre-nixos-start[896]:     "vda": [
Oct 17 02:58:02 nixos pre-nixos-start[896]:       {
Oct 17 02:58:02 nixos pre-nixos-start[896]:         "name": "vda1",
Oct 17 02:58:02 nixos pre-nixos-start[896]:         "type": "efi"
Oct 17 02:58:02 nixos pre-nixos-start[896]:       },
Oct 17 02:58:02 nixos pre-nixos-start[896]:       {
Oct 17 02:58:02 nixos pre-nixos-start[896]:         "name": "vda2",
Oct 17 02:58:02 nixos pre-nixos-start[896]:         "type": "lvm"
Oct 17 02:58:02 nixos pre-nixos-start[896]:       }
Oct 17 02:58:02 nixos pre-nixos-start[896]:     ]
Oct 17 02:58:02 nixos pre-nixos-start[896]:   },
Oct 17 02:58:02 nixos pre-nixos-start[896]:   "disko": {
Oct 17 02:58:02 nixos pre-nixos-start[896]:     "disk": {
Oct 17 02:58:02 nixos pre-nixos-start[896]:       "vda": {
Oct 17 02:58:02 nixos pre-nixos-start[896]:         "type": "disk",
Oct 17 02:58:02 nixos pre-nixos-start[896]:         "device": "/dev/vda",
Oct 17 02:58:02 nixos pre-nixos-start[896]:         "content": {
Oct 17 02:58:02 nixos pre-nixos-start[896]:           "type": "gpt",
Oct 17 02:58:02 nixos pre-nixos-start[896]:           "partitions": {
Oct 17 02:58:02 nixos pre-nixos-start[896]:             "vda1": {
Oct 17 02:58:02 nixos pre-nixos-start[896]:               "size": "1G",
Oct 17 02:58:02 nixos pre-nixos-start[896]:               "type": "EF00",
Oct 17 02:58:02 nixos pre-nixos-start[896]:               "content": {
Oct 17 02:58:02 nixos pre-nixos-start[896]:                 "type": "filesystem",
Oct 17 02:58:02 nixos pre-nixos-start[896]:                 "format": "vfat",
Oct 17 02:58:02 nixos pre-nixos-start[896]:                 "extraArgs": [
Oct 17 02:58:02 nixos pre-nixos-start[896]:                   "-n",
Oct 17 02:58:02 nixos pre-nixos-start[896]:                   "EFI"
Oct 17 02:58:02 nixos pre-nixos-start[896]:                 ],
Oct 17 02:58:02 nixos pre-nixos-start[896]:                 "mountpoint": "/boot",
Oct 17 02:58:02 nixos pre-nixos-start[896]:                 "mountOptions": [
Oct 17 02:58:02 nixos pre-nixos-start[896]:                   "umask=0077"
Oct 17 02:58:02 nixos pre-nixos-start[896]:                 ]
Oct 17 02:58:02 nixos pre-nixos-start[896]:               }
Oct 17 02:58:02 nixos pre-nixos-start[896]:             },
Oct 17 02:58:02 nixos pre-nixos-start[896]:             "vda2": {
Oct 17 02:58:02 nixos pre-nixos-start[896]:               "size": "100%",
Oct 17 02:58:02 nixos pre-nixos-start[896]:               "content": {
Oct 17 02:58:02 nixos pre-nixos-start[896]:                 "type": "lvm_pv",
Oct 17 02:58:02 nixos pre-nixos-start[896]:                 "vg": "main"
Oct 17 02:58:02 nixos pre-nixos-start[896]:               }
Oct 17 02:58:02 nixos pre-nixos-start[896]:             }
Oct 17 02:58:02 nixos pre-nixos-start[896]:           }
Oct 17 02:58:02 nixos pre-nixos-start[896]:         }
Oct 17 02:58:02 nixos pre-nixos-start[896]:       }
Oct 17 02:58:02 nixos pre-nixos-start[896]:     },
Oct 17 02:58:02 nixos pre-nixos-start[896]:     "mdadm": {},
Oct 17 02:58:02 nixos pre-nixos-start[8ip -o -4 addr show dev lan 2>/dev/null || true
96]:     "lvm_vg": {
Oct 17 02:58:02 nixos pre-nixos-start[896]:       "main": {
Oct 17 02:58:02 nixos pre-nixos-start[896]:         "type": "lvm_vg",
Oct 17 02:58:02 nixos pre-nixos-start[896]:         "lvs": {
Oct 17 02:58:02 nixos pre-nixos-start[896]:           "slash": {
Oct 17 02:58:02 nixos pre-nixos-start[896]:             "size": "3068M",
Oct 17 02:58:02 nixos pre-nixos-start[896]:             "content": {
Oct 17 02:58:02 nixos pre-nixos-start[896]:               "type": "filesystem",
Oct 17 02:58:02 nixos pre-nixos-start[896]:               "format": "ext4",
Oct 17 02:58:02 nixos pre-nixos-start[896]:               "mountpoint": "/",
Oct 17 02:58:02 nixos pre-nixos-start[896]:               "mountOptions": [
Oct 17 02:58:02 nixos pre-nixos-start[896]:                 "noatime"
Oct 17 02:58:02 nixos pre-nixos-start[896]:               ]
Oct 17 02:58:02 nixos pre-nixos-start[896]:             }
Oct 17 02:58:02 nixos pre-nixos-start[896]:           },
Oct 17 02:58:02 nixos pre-nixos-start[896]:           "swap": {
Oct 17 02:58:02 nixos pre-nixos-start[896]:             "size": "4M",
Oct 17 02:58:02 nixos pre-nixos-start[896]:             "content": {
Oct 17 02:58:02 nixos pre-nixos-start[896]:               "type": "swap"
Oct 17 02:58:02 nixos pre-nixos-start[896]:             }
Oct 17 02:58:02 nixos pre-nixos-start[896]:           }
Oct 17 02:58:02 nixos pre-nixos-start[896]:         }
Oct 17 02:58:02 nixos pre-nixos-start[896]:       }
Oct 17 02:58:02 nixos pre-nixos-start[896]:     }
Oct 17 02:58:02 nixos pre-nixos-start[896]:   }
Oct 17 02:58:02 nixos pre-nixos-start[896]: }
Oct 17 02:58:02 nixos pre-nixos-start[896]: Traceback (most recent call last):
Oct 17 02:58:02 nixos pre-nixos-start[896]:   File "/nix/store/gcskgp15adhp9y8dm8djf61giz3gl8fn-pre-nixos-0.1.0/bin/.pre-nixos-wrapped", line 9, in <module>
Oct 17 02:58:02 nixos pre-nixos-start[896]:     sys.exit(main())
Oct 17 02:58:02 nixos pre-nixos-start[896]:              ^^^^^^
Oct 17 02:58:02 nixos pre-nixos-start[896]:   File "/nix/store/gcskgp15adhp9y8dm8djf61giz3gl8fn-pre-nixos-0.1.0/lib/python3.11/site-packages/pre_nixos/pre_nixos.py", line 121, in main
Oct 17 02:58:02 nixos pre-nixos-start[896]:     apply.apply_plan(plan, dry_run=args.dry_run)
Oct 17 02:58:02 nixos pre-nixos-start[896]:   File "/nix/store/gcskgp15adhp9y8dm8djf61giz3gl8fn-pre-nixos-0.1.0/lib/python3.11/site-packages/pre_nixos/apply.py", line 118, in apply_plan
Oct 17 02:58:02 nixos pre-nixos-start[896]:     _run(cmd, execute)
Oct 17 02:58:02 nixos pre-nixos-start[896]:   File "/nix/store/gcskgp15adhp9y8dm8djf61giz3gl8fn-pre-nixos-0.1.0/lib/python3.11/site-packages/pre_nixos/apply.py", line 77, in _run
Oct 17 02:58:02 nixos pre-nixos-start[896]:     raise subprocess.CalledProcessError(result.returncode, cmd)
Oct 17 02:58:02 nixos pre-nixos-start[896]: subprocess.CalledProcessError: Command 'disko --mode destroy,format,mount --yes-wipe-all-disks --root-mountpoint /mnt /var/log/pre-nixos/disko-config.nix' returned non-zero exit status 5.
Oct 17 02:58:02 nixos systemd[1]: [0;1;39m[0;1;31m[0;1;39mpre-nixos.service: Main process exited, code=exited, status=1/FAILURE[0m
Oct 17 02:58:02 nixos systemd[1]: [0;1;38;5;185m[0;1;39m[0;1;38;5;185mpre-nixos.service: Failed with result 'exit-code'.[0m
Oct 17 02:58:02 nixos systemd[1]: [0;1;31m[0;1;39m[0;1;31mFailed to start Pre-NixOS setup.[0m
Oct 17 02:58:02 nixos systemd[1]: pre-nixos.service: Consumed 1min 22.176s CPU time, received 188B IP traffic, sent 924B IP traffic.
[?2004hPRE-NIXOS> ip -o -4 addr show dev lan 2>/dev/null || true
ip -o -4 addr show dev lan 2>/dev/null || true
[?2004l2: lan    inet [35m10.0.2.15[0m/24 metric 1024 brd [35m10.0.2.255 [0mscope global dynamic lan\       valid_lft 86289sec preferred_lft 86289sec
[?2004hPRE-NIXOS> ip -o -4 addr show dev lan 2>/dev/null || true
[?2004l2: lan    inet [35m10.0.2.15[0m/24 metric 1024 brd [35m10.0.2.255 [0mscope global dynamic lan\       valid_lft 86289sec preferred_lft 86289sec
[?2004hPRE-NIXOS> systemctl is-active pre-nixos
poweroff
ip -o -4 addr show dev lan 2>/dev/null || true
[?2004lsystemctl is-active pre-nixos
2: lan    inet [35m10.0.2.15[0m/24 metric 1024 brd [35m10.0.2.255 [0mscope global dynamic lan\       valid_lft 86284sec preferred_lft 86284sec
[?2004hPRE-NIXOS> systemctl is-active pre-nixos
[?2004lpoweroff
failed
[?2004hPRE-NIXOS> poweroff
[?2004l[0;1;31mCall to PowerOff failed: Interactive authentication required.[0m
[?2004hPRE-NIXOS> 
# VM integration attempts â€” 2025-12-24T00:34:20Z (UTC)

## Context
- Follow-on to the modular VM test plan after hardening UID parsing in `BootImageVM._read_uid`.
- Goal: rerun the full VM suite (`test_pre_nixos_vm.py` and `test_pre_nixos_cleanup.py`) and capture timings/logs.

## Runs
1. **00:22 UTC (notes/2025-12-24T002246Z-vm-run/)**
   - Command: `pytest tests/vm/test_pre_nixos_vm.py tests/vm/test_pre_nixos_cleanup.py -q`
   - Result: all scenarios errored during `_read_uid`; automatic console login produced UID markers, but parsing still failed before privilege escalation. Ledger entry recorded with failure.

2. **00:30 UTC (notes/2025-12-24T003039Z-vm-run/)**
   - Command: `pytest tests/vm/test_pre_nixos_vm.py tests/vm/test_pre_nixos_cleanup.py -q`
   - Timings: build ~330s, boot-to-login ~120s, boot-to-SSH ~188s, total ~203s (see metadata.json).
   - Result: preseed commands for the RAID/LVM residue scenario ran (mdadm/vgcreate/lvcreate) but reading the sentinel via `cat /dev/vg_residue/lv_residue` returned an empty string; the cleanup test failed on the missing `residue-marker`. Core pre-nixos scenarios passed.
   - Diagnostics: dmesg and `pre-nixos` journal captured in `logs/diagnostics/` plus harness/serial logs; ledger entry appended automatically.

## Next steps
- Inspect why the RAID/LVM sentinel write returned empty output despite the creation commands succeeding. Check for command failures in the harness/serial logs and verify device availability before and after the write.
- Consider adding explicit asserts on command exit codes/output in the cleanup plan to surface failures earlier.
